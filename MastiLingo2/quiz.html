<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MastiLingo Quiz</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Quicksand', sans-serif;
      background: linear-gradient(to top, #0f172a, #1e293b);
      color: #fff;
      text-align: center;
      padding: 30px 20px;
    }
    header h1 {
      font-size: 30px;
      color: #60a5fa;
      animation: flicker 2.5s infinite alternate;
    }
    @keyframes flicker {
      0% { opacity: 0.9; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.03); color: #3b82f6; }
      100% { opacity: 0.95; transform: scale(1); }
    }

    .quiz-container {
      background: #334155;
      padding: 30px;
      border-radius: 18px;
      max-width: 650px;
      margin: 40px auto;
      box-shadow: 0 8px 30px rgba(0,0,0,0.25);
    }

    .question-box {
      font-size: 24px;
      margin-bottom: 20px;
    }

    .options button {
      display: block;
      width: 90%;
      margin: 10px auto;
      padding: 12px;
      border: none;
      border-radius: 12px;
      background-color: #64748b;
      color: white;
      font-size: 18px;
      cursor: pointer;
      transition: 0.3s;
    }

    .options button:hover {
      background-color: #3b82f6;
    }

    .audio-btn {
      background: #1d4ed8;
      padding: 10px 20px;
      color: white;
      border: none;
      border-radius: 10px;
      margin-bottom: 20px;
      cursor: pointer;
    }

    #genie {
      width: 80px;
      position: fixed;
      bottom: 20px;
      right: 20px;
      animation: float 2.5s ease-in-out infinite;
      cursor: pointer;
    }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-12px); }
    }
  </style>
</head>
<body>
  <header>
    <h1>üßû Welcome to Your Language Quiz!</h1>
  </header>

  <div class="quiz-container">
    <div id="languageDisplay" style="margin-bottom:20px; font-size:18px;"></div>
    
    <div class="question-box" id="questionText">Loading...</div>

    <button class="audio-btn" onclick="playAudio()">üîä Hear Pronunciation</button>

    <div class="options" id="optionsArea"></div>

    <button onclick="nextQuestion()" style="margin-top: 20px; padding: 10px 20px; background: #16a34a; color: white; border: none; border-radius: 10px;">Next ‚û°Ô∏è</button>
  </div>

  <img id="genie" src="images/genie.png" onclick="genieTalk()" alt="Genie" />
  
  <audio id="wordAudio"></audio>
  <audio id="correctSound" src="sounds/success.mp3"></audio>
  <audio id="wrongSound" src="sounds/fail.mp3"></audio>

  <script>
    const quizData = {
      Hindi: [
        { word: "‡§®‡§Æ‡§∏‡•ç‡§§‡•á", translit: "Namaste", english: "Hello", audio: "audio/hindi/hindi_1.mp3", options: ["Hello", "Thank you", "Sorry", "Yes"] },
        { word: "‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶", translit: "Dhanyavaad", english: "Thank you", audio: "audio/hindi/hindi_2.mp3", options: ["Thank you", "Hello", "No", "Food"] },
        { word: "‡§ï‡•É‡§™‡§Ø‡§æ", translit: "Kripya", english: "Please", audio: "audio/hindi/hindi_3.mp3", options: ["Please", "Sorry", "Yes", "Water"] },
        { word: "‡§Æ‡•Å‡§ù‡•á ‡§Æ‡§æ‡§´ ‡§ï‡§∞‡•á‡§Ç", translit: "Mujhe maaf karein", english: "Sorry", audio: "audio/hindi/hindi_4.mp3", options: ["Sorry", "Hello", "No", "Food"] },
        { word: "‡§π‡§æ‡§Å", translit: "Haan", english: "Yes", audio: "audio/hindi/hindi_5.mp3", options: ["Yes", "No", "Thank you", "Please"] },
        { word: "‡§®‡§π‡•Ä‡§Ç", translit: "Nahin", english: "No", audio: "audio/hindi/hindi_6.mp3", options: ["No", "Yes", "Hello", "Food"] },
        { word: "‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§µ‡§æ‡§ó‡§§ ‡§π‡•à", translit: "Aapka swagat hai", english: "You're welcome", audio: "audio/hindi/hindi_7.mp3", options: ["You're welcome", "Thank you", "Sorry", "Hello"] },
        { word: "‡§ï‡•à‡§∏‡•á ‡§π‡•ã?", translit: "Kaise ho?", english: "How are you?", audio: "audio/hindi/hindi_8.mp3", options: ["How are you?", "What is your name?", "Goodbye", "Yes"] },
      ],
      Tamil: [
        { word: "‡Æµ‡Æ£‡Æï‡Øç‡Æï‡ÆÆ‡Øç", translit: "Vanakkam", english: "Hello", audio: "audio/tamil/tamil_1.mp3", options: ["Hello", "Food", "Yes", "Car"] },
        { word: "‡Æ®‡Æ©‡Øç‡Æ±‡Æø", translit: "Nandri", english: "Thank you", audio: "audio/tamil/tamil_2.mp3", options: ["Thank you", "Hello", "No", "Water"] },
        { word: "‡Æ§‡ÆØ‡Æµ‡ØÅ", translit: "Thayavu", english: "Please", audio: "audio/tamil/tamil_3.mp3", options: ["Please", "Sorry", "Yes", "Food"] },
        { word: "‡ÆÆ‡Æ©‡Øç‡Æ©‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç", translit: "Mannikkavum", english: "Sorry", audio: "audio/tamil/tamil_4.mp3", options: ["Sorry", "Hello", "No", "Thank you"] },
        { word: "‡ÆÜ‡ÆÆ‡Øç", translit: "Aam", english: "Yes", audio: "audio/tamil/tamil_5.mp3", options: ["Yes", "No", "Hello", "Food"] },
        { word: "‡Æá‡Æ≤‡Øç‡Æ≤‡Øà", translit: "Illai", english: "No", audio: "audio/tamil/tamil_6.mp3", options: ["No", "Yes", "Thank you", "Please"] },
        { word: "‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡Æ∞‡Æµ‡Øá‡Æ±‡Øç‡Æ™‡ØÅ", translit: "Ungal varaverpu", english: "You're welcome", audio: "audio/tamil/tamil_7.mp3", options: ["You're welcome", "Thank you", "Sorry", "Hello"] },
        { word: "‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æé‡Æ™‡Øç‡Æ™‡Æü‡Æø ‡Æá‡Æ∞‡ØÅ‡Æï‡Øç‡Æï‡Æø‡Æ±‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç?", translit: "Neenga epadi irukkirirgal?", english: "How are you?", audio: "audio/tamil/tamil_8.mp3", options: ["How are you?", "What is your name?", "Goodbye", "Yes"] },
      ],
      Kannada: [
        { word: "‡≤®‡≤Æ‡≤∏‡≥ç‡≤ï‡≤æ‡≤∞", translit: "NamaskƒÅra", english: "Hello", audio: "audio/kannada/kannada_1.mp3", options: ["Hello", "Goodbye", "Book", "School"] },
        { word: "‡≤ß‡≤®‡≥ç‡≤Ø‡≤µ‡≤æ‡≤¶", translit: "DhanyavƒÅda", english: "Thank you", audio: "audio/kannada/kannada_2.mp3", options: ["Thank you", "Hello", "No", "Food"] },
        { word: "‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å", translit: "Dayavittu", english: "Please", audio: "audio/kannada/kannada_3.mp3", options: ["Please", "Sorry", "Yes", "Water"] },
        { word: "‡≤ï‡≥ç‡≤∑‡≤Æ‡≤ø‡≤∏‡≤ø", translit: "Kshamisi", english: "Sorry", audio: "audio/kannada/kannada_4.mp3", options: ["Sorry", "Hello", "No", "Thank you"] },
        { word: "‡≤π‡≥å‡≤¶‡≥Å", translit: "Howdu", english: "Yes", audio: "audio/kannada/kannada_5.mp3", options: ["Yes", "No", "Hello", "Food"] },
        { word: "‡≤á‡≤≤‡≥ç‡≤≤", translit: "Illa", english: "No", audio: "audio/kannada/kannada_6.mp3", options: ["No", "Yes", "Thank you", "Please"] },
        { word: "‡≤®‡≥Ä‡≤µ‡≥Å ‡≤∏‡≥ç‡≤µ‡≤æ‡≤ó‡≤§", translit: "Neenu swagata", english: "You're welcome", audio: "audio/kannada/kannada_7.mp3", options: ["You're welcome", "Thank you", "Sorry", "Hello"] },
        { word: "‡≤®‡≥Ä‡≤µ‡≥Å ‡≤π‡≥á‡≤ó‡≤ø‡≤¶‡≥ç‡≤¶‡≥Ä‡≤∞‡≤æ?", translit: "Neenu hegiddira?", english: "How are you?", audio: "audio/kannada/kannada_8.mp3", options: ["How are you?", "What is your name?", "Goodbye", "Yes"] },
      ],
      Telugu: [
        { word: "‡∞®‡∞Æ‡∞∏‡±ç‡∞§‡±á", translit: "Namastƒì", english: "Hello", audio: "audio/telugu/telugu_1.mp3", options: ["Hello", "Chair", "Pen", "Friend"] },
        { word: "‡∞ß‡∞®‡±ç‡∞Ø‡∞µ‡∞æ‡∞¶‡∞æ‡∞≤‡±Å", translit: "DhanyavƒÅdƒÅlu", english: "Thank you", audio: "audio/telugu/telugu_2.mp3", options: ["Thank you", "Hello", "No", "Food"] },
        { word: "‡∞¶‡∞Ø‡∞ö‡±á‡∞∏‡∞ø", translit: "Dayachƒìsi", english: "Please", audio: "audio/telugu/telugu_3.mp3", options: ["Please", "Sorry", "Yes", "Water"] },
        { word: "‡∞ï‡±ç‡∞∑‡∞Æ‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø", translit: "Kshaminchandi", english: "Sorry", audio: "audio/telugu/telugu_4.mp3", options: ["Sorry", "Hello", "No", "Thank you"] },
        { word: "‡∞Ö‡∞µ‡±Å‡∞®‡±Å", translit: "Avunu", english: "Yes", audio: "audio/telugu/telugu_5.mp3", options: ["Yes", "No", "Hello", "Food"] },
        { word: "‡∞ï‡∞æ‡∞¶‡±Å", translit: "KƒÅdu", english: "No", audio: "audio/telugu/telugu_6.mp3", options: ["No", "Yes", "Thank you", "Please"] },
        { word: "‡∞Æ‡±Ä‡∞∞‡±Å ‡∞∏‡±ç‡∞µ‡∞æ‡∞ó‡∞§‡∞Ç", translit: "Meeru swagatham", english: "You're welcome", audio: "audio/telugu/telugu_7.mp3", options: ["You're welcome", "Thank you", "Sorry", "Hello"] },
        { word: "‡∞Æ‡±Ä‡∞∞‡±Å ‡∞é‡∞≤‡∞æ ‡∞â‡∞®‡±ç‡∞®‡∞æ‡∞∞‡±Å?", translit: "Meeru ela unnaru?", english: "How are you?", audio: "audio/telugu/telugu_8.mp3", options: ["How are you?", "What is your name?", "Goodbye", "Yes"] },
      ],
      Malayalam: [
        { word: "‡¥®‡¥Æ‡¥∏‡µç‡¥ï‡¥æ‡¥∞‡¥Ç", translit: "NamaskƒÅram", english: "Hello", audio: "audio/malayalam/malayalam_1.mp3", options: ["Hello", "Rain", "Sun", "Thank you"] },
        { word: "‡¥®‡¥®‡µç‡¥¶‡¥ø", translit: "Nandi", english: "Thank you", audio: "audio/malayalam/malayalam_2.mp3", options: ["Thank you", "Hello", "No", "Food"] },
        { word: "‡¥¶‡¥Ø‡¥µ‡¥æ‡¥Ø‡¥ø", translit: "Dayavaayi", english: "Please", audio: "audio/malayalam/malayalam_3.mp3", options: ["Please", "Sorry", "Yes", "Water"] },
        { word: "‡¥ï‡µç‡¥∑‡¥Æ‡¥ø‡¥ï‡µç‡¥ï‡¥£‡¥Ç", translit: "Kshamikkanam", english: "Sorry", audio: "audio/malayalam/malayalam_4.mp3", options: ["Sorry", "Hello", "No", "Thank you"] },
        { word: "‡¥Ö‡¥§‡µÜ", translit: "Athe", english: "Yes", audio: "audio/malayalam/malayalam_5.mp3", options: ["Yes", "No", "Hello", "Food"] },
        { word: "‡¥á‡¥≤‡µç‡¥≤", translit: "Illa", english: "No", audio: "audio/malayalam/malayalam_6.mp3", options: ["No", "Yes", "Thank you", "Please"] },
        { word: "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥∏‡µç‡¥µ‡¥æ‡¥ó‡¥§‡¥Ç", translit: "Ningalude swƒÅgatham", english: "You're welcome", audio: "audio/malayalam/malayalam_7.mp3", options: ["You're welcome", "Thank you", "Sorry", "Hello"] },
        { word: "‡¥∏‡µÅ‡¥ñ‡¥Æ‡¥æ‡¥£‡µã?", translit: "Sukhamaano?", english: "How are you?", audio: "audio/malayalam/malayalam_8.mp3", options: ["How are you?", "What is your name?", "Goodbye", "Yes"] },
      ]
    };

    let currentLang = localStorage.getItem("selectedLanguage") || "Hindi";
    let currentQuestion = 0;

    document.getElementById("languageDisplay").innerText = `üåê Language: ${currentLang}`;

    function loadQuestion() {
      const q = quizData[currentLang][currentQuestion];
      if (!q) {
        showFlashboard();
        return;
      }
      document.getElementById("questionText").innerHTML = `${q.word} (${q.translit})`;
      document.getElementById("wordAudio").src = q.audio || "";
      // Shuffle options
      function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }
      const shuffledOptions = shuffle((q.options || []).slice());
      const optionsHTML = shuffledOptions.map(opt => `
        <button onclick="checkAnswer('${opt}', '${q.english}')">${opt}</button>
      `).join("");
      document.getElementById("optionsArea").innerHTML = optionsHTML;
    }

    // Flashboard screen after level completion
    function showFlashboard() {
      // Remove quiz container
      const quizContainer = document.querySelector('.quiz-container');
      if (quizContainer) quizContainer.style.display = 'none';

      // Remove feedback animation if present
      const feedback = document.getElementById('feedbackAnim');
      if (feedback) feedback.style.display = 'none';

      // Create flashboard overlay
      let flashboard = document.getElementById('flashboardScreen');
      if (!flashboard) {
        flashboard = document.createElement('div');
        flashboard.id = 'flashboardScreen';
        flashboard.style.position = 'fixed';
        flashboard.style.top = '0';
        flashboard.style.left = '0';
        flashboard.style.width = '100vw';
        flashboard.style.height = '100vh';
        flashboard.style.background = 'linear-gradient(135deg, #60a5fa 0%, #16a34a 100%)';
        flashboard.style.display = 'flex';
        flashboard.style.flexDirection = 'column';
        flashboard.style.justifyContent = 'center';
        flashboard.style.alignItems = 'center';
        flashboard.style.zIndex = '99999';
        flashboard.style.animation = 'fadeInFlash 1s';
        flashboard.innerHTML = `
          <style>
            @keyframes fadeInFlash {
              from { opacity: 0; }
              to { opacity: 1; }
            }
            .flashboard-card {
              background: rgba(255,255,255,0.95);
              border-radius: 24px;
              box-shadow: 0 8px 32px rgba(0,0,0,0.18);
              padding: 40px 60px;
              text-align: center;
              max-width: 420px;
              animation: popIn 0.7s;
            }
            @keyframes popIn {
              0% { transform: scale(0.7); opacity: 0; }
              80% { transform: scale(1.05); opacity: 1; }
              100% { transform: scale(1); }
            }
            .flashboard-title {
              font-size: 2.2em;
              font-weight: bold;
              color: #16a34a;
              margin-bottom: 18px;
            }
            .flashboard-desc {
              font-size: 1.2em;
              color: #334155;
              margin-bottom: 30px;
            }
            .go-next-btn {
              background: linear-gradient(90deg, #3b82f6 0%, #16a34a 100%);
              color: #fff;
              font-size: 1.1em;
              font-weight: bold;
              border: none;
              border-radius: 12px;
              padding: 16px 38px;
              cursor: pointer;
              box-shadow: 0 2px 12px rgba(0,0,0,0.12);
              transition: background 0.3s, transform 0.2s;
            }
            .go-next-btn:hover {
              background: linear-gradient(90deg, #16a34a 0%, #3b82f6 100%);
              transform: scale(1.07);
            }
          </style>
          <div class="flashboard-card">
            <div class="flashboard-title">üéâ Level 1 Complete!</div>
            <div class="flashboard-desc">Great job! You finished all questions in this level.<br>Ready for the next challenge?</div>
            <button class="go-next-btn" id="goNextBtn">Go to Level 2 ‚û°Ô∏è</button>
          </div>
        `;
        document.body.appendChild(flashboard);
        // Attach event listener for next level button
        setTimeout(() => {
          const btn = document.getElementById('goNextBtn');
          if (btn) btn.onclick = goToNextLevel;
        }, 100);
      } else {
        flashboard.style.display = 'flex';
      }
    }

    // Next level logic
    function goToNextLevel() {
      const flashboard = document.getElementById('flashboardScreen');
      if (flashboard) flashboard.style.display = 'none';
      // Show quiz container again (could load new questions here)
      const quizContainer = document.querySelector('.quiz-container');
      if (quizContainer) quizContainer.style.display = '';
      // TODO: Load level 2 questions or redirect as needed
      // For now, just reset to first question
      currentQuestion = 0;
      loadQuestion();
    }

    function playAudio() {
      const q = quizData[currentLang][currentQuestion];
      if (
        (currentLang === "Hindi" || currentLang === "Kannada") &&
        window.responsiveVoice &&
        typeof window.responsiveVoice.speak === "function"
      ) {
        // Use ResponsiveVoice for Hindi and Kannada
        const voice = currentLang === "Hindi" ? "Hindi Female" : "Kannada Female";
        window.responsiveVoice.speak(q.word, voice);
      } else if (q.audio) {
        const audio = document.getElementById("wordAudio");
        audio.play();
      }
    }

    function checkAnswer(selected, correct) {
      if (selected === correct) {
        document.getElementById("correctSound").play();
        showFeedback(true);
      } else {
        document.getElementById("wrongSound").play();
        showFeedback(false);
      }
    // Show feedback animation for correct/wrong answer
    function showFeedback(isCorrect) {
      let feedback = document.getElementById("feedbackAnim");
      if (!feedback) {
        feedback = document.createElement("div");
        feedback.id = "feedbackAnim";
        feedback.style.position = "fixed";
        feedback.style.top = "50%";
        feedback.style.left = "50%";
        feedback.style.transform = "translate(-50%, -50%)";
        feedback.style.zIndex = "9999";
        feedback.style.fontSize = "48px";
        feedback.style.fontWeight = "bold";
        feedback.style.padding = "30px 60px";
        feedback.style.borderRadius = "20px";
        feedback.style.boxShadow = "0 4px 24px rgba(0,0,0,0.3)";
        feedback.style.transition = "opacity 0.3s";
        document.body.appendChild(feedback);
      }
      if (isCorrect) {
        feedback.innerText = "‚úÖ Correct!";
        feedback.style.background = "#16a34a";
        feedback.style.color = "#fff";
      } else {
        feedback.innerText = "‚ùå Wrong! Try again!";
        feedback.style.background = "#ef4444";
        feedback.style.color = "#fff";
      }
      feedback.style.opacity = "1";
      setTimeout(() => {
        feedback.style.opacity = "0";
      }, 1200);
    }
    }

    function nextQuestion() {
      currentQuestion++;
      loadQuestion();
    }

    function genieTalk() {
      alert("üßû‚Äç‚ôÇÔ∏è I'm here to guide you through your language journey!");
    }

  // Wait for ResponsiveVoice to load before first question
  function waitForResponsiveVoice(cb) {
    if (window.responsiveVoice && typeof window.responsiveVoice.speak === "function") {
      cb();
    } else {
      setTimeout(() => waitForResponsiveVoice(cb), 100);
    }
  }
  if (currentLang === "Hindi" || currentLang === "Kannada") {
    waitForResponsiveVoice(loadQuestion);
  } else {
    loadQuestion();
  }
  </script>
  <!-- ResponsiveVoice JS -->
  <script src="https://code.responsivevoice.org/responsivevoice.js?key=Kzoi5Odx"></script>
</body>
</html>